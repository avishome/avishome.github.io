<!DOCTYPE html>
<html>
<head>
  <title>OAuth Demo</title>
</head>
<body>
  <h1>OAuth Token Exchange</h1>
    <input id="secret" />
    <button onclick="create(secret.value)">send</button>
  <pre id="result">Loading...</pre>

  <script>
      function create(key){
    // הגדר כאן את הפרטים שלך
    const clientId = '695845058871-a2lh5oisrupk1pe9lf1sqvljfm9jrj8a.apps.googleusercontent.com';
    const clientSecret = key; // לא בטוח לשים את זה פה!
    const redirectUri = 'https://avishome.github.io/hh2.html';
    const tokenEndpoint = 'https://oauth2.googleapis.com/token';

    // קח את הקוד מה-URL
    const params = new URLSearchParams(window.location.search);
    const code = params.get('code');
    const resultElem = document.getElementById('result');

    if (code) {
      fetch(tokenEndpoint, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
        },
        body: new URLSearchParams({
          code: code,
          client_id: clientId,
          client_secret: clientSecret,
          redirect_uri: redirectUri,
          grant_type: 'authorization_code'
        })
      })
      .then(res => res.json())
      .then(data => {
        console.log(data);
        resultElem.textContent = JSON.stringify(data, null, 2);
      })
      .catch(err => {
        console.error(err);
        resultElem.textContent = 'Error: ' + err.message;
      });
    } else {
      resultElem.textContent = 'No authorization code found in URL.';
    }
      }
  </script>
</body>
</html>
